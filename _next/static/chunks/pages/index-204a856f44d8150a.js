(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{8312:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return t(7470)}])},7470:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return A}});var i=t(5893),o=t(1693),r=t(4948),c=t(2743),l=t(7294),a=t(603),s=t(7674),d=t(7741),p=t(9604),u=t(4480),x=(0,u.cn)({key:"exportCodeModalStatus",default:!1}),h=(0,u.cn)({key:"exportXmlModalStatus",default:!1}),m=(0,u.cn)({key:"importXmlModalStatus",default:!1}),k=((0,u.cn)({key:"code",default:""}),t(5466));function C(){var e=(0,a.Z)((0,u.FV)(x),2),n=e[0],t=e[1],o=function(e){var n=e||r.getMainWorkspace(),t=n?k.javascriptGenerator.workspaceToCode(n):"";return"(async function main() { \n\t".concat(null===t||void 0===t?void 0:t.replace(/\n/g,"\n\t"),"\n})()\n")}(),c=function(){t(!1)};return(0,i.jsx)("div",{children:(0,i.jsxs)(s.u_,{isOpen:n,onClose:c,isCentered:!0,children:[(0,i.jsx)(s.ZA,{}),(0,i.jsxs)(s.hz,{maxW:"1000px",h:"600px",children:[(0,i.jsx)(s.xB,{children:"\u5bfc\u51faEpub360\u81ea\u5b9a\u4e49\u4ee3\u7801"}),(0,i.jsx)(s.ol,{}),(0,i.jsx)(s.fe,{children:(0,i.jsx)(p.ZP,{defaultLanguage:"javascript",defaultValue:o,options:{autoIndent:"full"}})}),(0,i.jsx)(s.mz,{children:(0,i.jsx)(d.zx,{colorScheme:"blue",mr:3,onClick:c,children:"\u5173\u95ed"})})]})]})})}function _(){var e=(0,a.Z)((0,u.FV)(h),2),n=e[0],t=e[1],o=function(e){var n=e||r.getMainWorkspace();try{var t=r.Xml.workspaceToDom(n);return function(e){var n=" ".repeat(2),t=0;return e.replace(/(>)(<)(\/*)/g,"$1\r\n$2$3").split("\r\n").map((function(e){var i=0;return e.match(/.+<\/\w[^>]*>$/)?i=0:e.match(/^<\/\w/)&&t>0?t-=1:i=e.match(/^<\w[^>]*[^/]>.*$/)?1:0,t+=i,n.repeat(t-i)+e})).join("\r\n")}(r.Xml.domToText(t))}catch(i){return""}}(),c=function(){t(!1)};return(0,i.jsx)("div",{children:(0,i.jsxs)(s.u_,{isOpen:n,onClose:c,isCentered:!0,children:[(0,i.jsx)(s.ZA,{}),(0,i.jsxs)(s.hz,{maxW:"1000px",h:"600px",children:[(0,i.jsx)(s.xB,{children:"\u5bfc\u51faXml\u914d\u7f6e\u4ee3\u7801"}),(0,i.jsx)(s.ol,{}),(0,i.jsx)(s.fe,{children:(0,i.jsx)(p.ZP,{defaultLanguage:"xml",defaultValue:o,options:{formatOnPaste:!0}})}),(0,i.jsx)(s.mz,{children:(0,i.jsx)(d.zx,{colorScheme:"blue",mr:3,onClick:c,children:"\u5173\u95ed"})})]})]})})}function f(){var e=(0,a.Z)(l.useState(""),2),n=e[0],t=e[1],o=(0,a.Z)((0,u.FV)(m),2),c=o[0],x=o[1],h=function(){x(!1)};return(0,i.jsx)("div",{children:(0,i.jsxs)(s.u_,{isOpen:c,onClose:h,isCentered:!0,size:"xl",children:[(0,i.jsx)(s.ZA,{}),(0,i.jsxs)(s.hz,{maxW:"1000px",h:"600px",children:[(0,i.jsx)(s.xB,{children:"\u5bfc\u5165Xml\u914d\u7f6e\u4ee3\u7801"}),(0,i.jsx)(s.ol,{}),(0,i.jsx)(s.fe,{children:(0,i.jsx)(p.ZP,{defaultLanguage:"xml",defaultValue:"",options:{autoIndent:"full",formatOnPaste:!0},onChange:function(e){t(e||"")},onMount:function(e){e.focus()}})}),(0,i.jsxs)(s.mz,{children:[(0,i.jsx)(d.zx,{colorScheme:"gray",mr:3,onClick:h,children:"\u53d6\u6d88"}),(0,i.jsx)(d.zx,{colorScheme:"blue",mr:3,onClick:function(){!function(e,n){var t=e||'<xml xmlns="https://developers.google.com/blockly/xml"></xml>',i=n||r.getMainWorkspace();try{var o=r.Xml.textToDom(t);r.Xml.domToWorkspace(o,i)}catch(c){console.log(c)}}(n),h()},children:"\u786e\u8ba4"})]})]})]})})}function y(){return(0,i.jsxs)("div",{children:[(0,i.jsx)(C,{}),(0,i.jsx)(_,{}),(0,i.jsx)(f,{})]})}r.Blocks.epub_overlay_from_eid={init:function(){this.appendValueInput("EID").setCheck("String").appendField("\u83b7\u53d6EID="),this.appendDummyInput().appendField("\u7684\u5143\u7d20"),this.setInputsInline(!0),this.setOutput(!0,null),this.setColour(230),this.setTooltip("\u901a\u8fc7Eid\u6765\u83b7\u53d6Epub360\u7ec4\u4ef6\u5143\u7d20"),this.setHelpUrl("")}},k.javascriptGenerator.epub_overlay_from_eid=function(e){var n=k.javascriptGenerator.valueToCode(e,"EID",k.javascriptGenerator.ORDER_ATOMIC);return["$api.overlay.getOverlayModelByEid(".concat(n,")"),k.javascriptGenerator.ORDER_NONE]};var j={move:{scrollbars:!0,drag:!0,wheel:!0},theme:"zelos",toolbox:{contents:[{kind:"CATEGORY",name:"\u901a\u7528\u529f\u80fd",id:"catCommonWrapper",expanded:"true",contents:[{kind:"CATEGORY",contents:[{kind:"BLOCK",type:"controls_if"},{kind:"BLOCK",type:"logic_compare"},{kind:"BLOCK",type:"logic_operation"},{kind:"BLOCK",type:"logic_negate"},{kind:"BLOCK",type:"logic_boolean"},{kind:"BLOCK",type:"logic_null"}],id:"catLogic",colour:"210",name:"\u903b\u8f91"},{kind:"CATEGORY",contents:[{kind:"BLOCK",type:"controls_repeat_ext"},{kind:"BLOCK",type:"controls_whileUntil"},{kind:"BLOCK",type:"controls_for"},{kind:"BLOCK",type:"controls_forEach"},{kind:"BLOCK",type:"controls_flow_statements"}],id:"catLoops",colour:"120",name:"\u5faa\u73af"},{kind:"CATEGORY",contents:[{kind:"BLOCK",type:"math_number"},{kind:"BLOCK",type:"math_arithmetic"},{kind:"BLOCK",type:"math_single"},{kind:"BLOCK",type:"math_trig"},{kind:"BLOCK",type:"math_constant"},{kind:"BLOCK",type:"math_number_property"},{kind:"BLOCK",type:"math_round"},{kind:"BLOCK",type:"math_on_list"},{kind:"BLOCK",type:"math_modulo"},{kind:"BLOCK",type:"math_constrain"},{kind:"BLOCK",type:"math_random_int"},{kind:"BLOCK",type:"math_random_float"}],id:"catMath",colour:"230",name:"\u8fd0\u7b97"},{kind:"CATEGORY",contents:[{kind:"BLOCK",type:"text"},{kind:"BLOCK",type:"text_join"},{kind:"BLOCK",type:"text_append"},{kind:"BLOCK",type:"text_length"},{kind:"BLOCK",type:"text_isEmpty"},{kind:"BLOCK",type:"text_indexOf"},{kind:"BLOCK",type:"text_charAt"},{kind:"BLOCK",type:"text_getSubstring"},{kind:"BLOCK",type:"text_changeCase"},{kind:"BLOCK",type:"text_trim"},{kind:"BLOCK",type:"text_print"},{kind:"BLOCK",type:"text_prompt_ext"}],id:"catText",colour:"160",name:"\u6587\u672c"},{kind:"CATEGORY",contents:[{kind:"BLOCK",type:"lists_create_with"},{kind:"BLOCK",type:"lists_repeat"},{kind:"BLOCK",type:"lists_length"},{kind:"BLOCK",type:"lists_isEmpty"},{kind:"BLOCK",type:"lists_indexOf"},{kind:"BLOCK",type:"lists_getIndex"},{kind:"BLOCK",type:"lists_setIndex"},{kind:"BLOCK",type:"lists_getSublist"},{kind:"BLOCK",type:"lists_split"},{kind:"BLOCK",type:"lists_sort"}],id:"catLists",colour:"260",name:"\u5217\u8868"},{kind:"CATEGORY",contents:[{kind:"BLOCK",type:"colour_picker"},{kind:"BLOCK",type:"colour_random"},{kind:"BLOCK",type:"colour_rgb"},{kind:"BLOCK",type:"colour_blend"}],id:"catColour",colour:"20",name:"\u989c\u8272"},{kind:"CATEGORY",id:"catVariables",colour:"330",custom:"VARIABLE",name:"\u53d8\u91cf"},{kind:"CATEGORY",id:"catFunctions",colour:"290",custom:"PROCEDURE",name:"\u51fd\u6570"},{kind:"SEP"}]},{kind:"CATEGORY",name:"Epub\u529f\u80fd",id:"catEpubWrapper",expanded:"true",contents:[{kind:"CATEGORY",name:"\u5143\u7d20",id:"epubOverlay",colour:"240",contents:[{kind:"BLOCK",blockxml:'<block type=\'epub_overlay_from_eid\'>\n      <value name="EID">\n      <shadow type="text">\n        <field name="TEXT"></field>\n      </shadow>\n    </value>\n    </block>\n    '}]}]}],kind:"categoryToolbox",id:"toolbox",style:"display: none"},media:"https://unpkg.creatby.com/blockly/media/",grid:{spacing:25,length:3,colour:"#ccc",snap:!0},zoom:{controls:!0,startScale:.6,maxScale:3,minScale:.3,scaleSpeed:1.2},renderer:"zelos"};function O(){var e,n=l.useRef(null);return l.useEffect((function(){return(null===n||void 0===n?void 0:n.current)&&(e=r.inject(null===n||void 0===n?void 0:n.current,j)),function(){null===e||void 0===e||e.dispose()}})),(0,i.jsxs)("div",{className:"app",children:[(0,i.jsx)("div",{className:"blockly-container h-screen",ref:n}),(0,i.jsx)(y,{})]})}r.setLocale(c);var v=t(9008),B=t.n(v),L=t(1163),g=t(2962),K="epubBlocklyEditor",E="zh",b=function(e){var n=(0,L.useRouter)();return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(B(),{children:[(0,i.jsx)("meta",{charSet:"UTF-8"},"charset"),(0,i.jsx)("meta",{name:"viewport",content:"width=device-width,initial-scale=1"},"viewport"),(0,i.jsx)("link",{rel:"apple-touch-icon",href:"".concat(n.basePath,"/apple-touch-icon.png")},"apple"),(0,i.jsx)("link",{rel:"icon",type:"image/png",sizes:"32x32",href:"".concat(n.basePath,"/favicon-32x32.png")},"icon32"),(0,i.jsx)("link",{rel:"icon",type:"image/png",sizes:"16x16",href:"".concat(n.basePath,"/favicon-16x16.png")},"icon16"),(0,i.jsx)("link",{rel:"icon",href:"".concat(n.basePath,"/favicon.ico")},"favicon")]}),(0,i.jsx)(g.PB,{title:e.title,description:e.description,canonical:e.canonical,openGraph:{title:e.title,description:e.description,url:e.canonical,locale:E,site_name:K}})]})},T=t(3382),w=t(2613);function R(){var e=(0,u.Zl)(x),n=(0,u.Zl)(h),t=(0,u.Zl)(m);return(0,i.jsx)("div",{className:"absolute top-2 right-2 z-10",children:(0,i.jsxs)(w.v2,{children:[(0,i.jsx)(w.j2,{as:d.hU,"aria-label":"Options",icon:(0,i.jsx)(T.Uq,{}),variant:"outline"}),(0,i.jsxs)(w.qy,{children:[(0,i.jsx)(w.sN,{icon:(0,i.jsx)(T._8,{}),onClickCapture:function(){return e(!0)},children:"\u5bfc\u51fa\u4ee3\u7801"}),(0,i.jsx)(w.sN,{icon:(0,i.jsx)(T.h0,{}),onClickCapture:function(){return n(!0)},children:"\u5bfc\u51faXml\u914d\u7f6e"}),(0,i.jsx)(w.sN,{icon:(0,i.jsx)(T.dt,{}),onClickCapture:function(){return t(!0)},children:"\u5bfc\u5165Xml\u914d\u7f6e"}),(0,i.jsx)(w.sN,{icon:(0,i.jsx)(T.pJ,{}),onClickCapture:function(){var e;(e||r.getMainWorkspace()).clear()},children:"\u6e05\u7a7a\u753b\u5e03"})]})]})})}var z=function(e){return(0,i.jsx)(u.Wh,{children:(0,i.jsxs)("div",{className:"w-full text-gray-700 antialiased",children:[e.meta,(0,i.jsx)(R,{}),(0,i.jsx)("div",{className:"mx-auto h-screen w-full",children:(0,i.jsx)("div",{className:"content w-full text-xl",children:e.children})})]})})},A=function(){return(0,i.jsx)(o.xjn,{children:(0,i.jsx)(z,{meta:(0,i.jsx)(b,{title:"Epub360 Block Editor",description:"Epub360 Block Editor"}),children:(0,i.jsx)(O,{})})})}}},function(e){e.O(0,[107,978,714,774,888,179],(function(){return n=8312,e(e.s=n);var n}));var n=e.O();_N_E=n}]);